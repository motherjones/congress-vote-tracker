/*! Syria Vote - v0.1.0 - 2013-09-05
* https://github.com/motherjones/syria
* Copyright (c) 2013 Mother Jones Data Desk; Licensed MIT */
"use strict";var current_d=199,current_r=234,current_empty=2,total_seats=435,tooltip_template="     <h3>{member}</h3>     <p>Party Affiliation: {party}</p>     <p>{strength} {lean}</p> ",compiled_tooltip=dust.compile(tooltip_template,"tooltip");dust.loadSource(compiled_tooltip),window.onload=function(){Tabletop.init({key:public_spreadsheet_url,callback:function(t){var e=cleanup_dataset(t);count_whip(e)},simpleSheet:!0})};var cleanup_dataset=function(t){for(var e={D:{yes:{strong:[],weak:[]},no:{strong:[],weak:[]},unknown:[],undecided:[]},R:{yes:{strong:[],weak:[]},no:{strong:[],weak:[]},unknown:[],undecided:[]},I:{yes:{strong:[],weak:[]},no:{strong:[],weak:[]},unknown:[],undecided:[]}},a=0,o=0,n=0,s=0;t.length>s;s++){var l=t[s].lean=t[s].undecided?"undecided":t[s].unknown?"unknown":t[s].no||t[s].leanno?"no":"yes",r=t[s].strength=t[s].undecided||t[s].unknown?"":t[s].no||t[s].yes?"strong":"weak";"D"===t[s].party?a++:"R"===t[s].party?o++:"I"===t[s].party&&n++,dust.render("tooltip",t[s],function(e,a){t[s].tooltip=a});var d={name:t[s].member,party:t[s].party,lean:l+r,tooltip:t[s].tooltip};"undecided"===l||"unknown"===l?e[t[s].party][l].push(d):e[t[s].party][l][r].push(d)}return e},count_whip=function(t){for(var e=t.D.no.strong,a=0;e.length>a;a++){var o=document.getElementById("seat"+a);o.className.baseVal="strongDno",o.setAttribute("data-tooltip",e[a].tooltip)}for(var n=t.D.no.weak,a=0;n.length>a;a++){var o=document.getElementById("seat"+(a+0+e.length));o.className.baseVal="weakDno",o.setAttribute("data-tooltip",n[a].tooltip)}for(var s=t.R.no.strong,a=0;s.length>a;a++){var o=document.getElementById("seat"+(total_seats-a-1));o.className.baseVal="strongRno",o.setAttribute("data-tooltip",s[a].tooltip)}for(var l=t.R.no.weak,a=0;l.length>a;a++){var o=document.getElementById("seat"+(total_seats-a-s.length-1));o.className.baseVal="weakRno",o.setAttribute("data-tooltip",l[a].tooltip)}for(var r=current_d-1,d=t.D.yes.strong,a=0;d.length>a;a++){var o=document.getElementById("seat"+(r-a));o.className.baseVal="strongDyes",o.setAttribute("data-tooltip",d[a].tooltip)}for(var i=t.D.yes.weak,a=0;i.length>a;a++){var o=document.getElementById("seat"+(r-a-d.length));o.className.baseVal="weakDyes",o.setAttribute("data-tooltip",i[a].tooltip)}for(var u=total_seats-current_r,p=t.R.yes.strong,a=0;p.length>a;a++){var o=document.getElementById("seat"+(u+a));o.className.baseVal="strongRyes",o.setAttribute("data-tooltip",p[a].tooltip)}for(var c=t.R.yes.weak,a=0;c.length>a;a++){var o=document.getElementById("seat"+(u+a+p.length));o.className.baseVal="weakRyes",o.setAttribute("data-tooltip",c[a].tooltip)}for(var m=n.length+i.length+2,g=t.D.undecided,a=0;g.length>a;a++){var o=document.getElementById("seat"+(m+a+1));o.className.baseVal="d_undecided",o.setAttribute("data-tooltip",g[a].tooltip)}for(var y=t.D.unknown,a=0;y.length>a;a++){var o=document.getElementById("seat"+(m+a+g.length+1));o.className.baseVal="d_unknown",o.setAttribute("data-tooltip",y[a].tooltip)}for(var b=total_seats-1-(l.length+s.length),v=t.R.undecided,a=0;v.length>a;a++){var o=document.getElementById("seat"+(b-a));o.className.baseVal="r_undecided",o.setAttribute("data-tooltip",v[a].tooltip)}for(var h=t.R.unknown,a=0;h.length>a;a++){var o=document.getElementById("seat"+(b-a-v.length));o.className.baseVal="r_unknown",o.setAttribute("data-tooltip",h[a].tooltip+h[a].lean)}document.getElementById("seat199").className.baseVal="empty_seat",document.getElementById("seat200").className.baseVal="empty_seat",document.getElementById("seat199").setAttribute("data-tooltip","Empty Seat"),document.getElementById("seat200").setAttribute("data-tooltip","Empty Seat");var w=jQuery('<div id="tooltip" style="display: none; position: absolute;"><p>text</p></div>');jQuery("svg").before(w),jQuery("svg circle").bind("mouseout",function(){w.css("display","none")}),jQuery("svg circle").bind("mousemove",function(t){w.css("left",t.pageX+10).css("top",t.pageY+10).css("display","block").html(jQuery(this).attr("data-tooltip"))})};